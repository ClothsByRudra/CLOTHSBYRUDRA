<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Auth | ClothsByRudra</title>
  <style>
    :root{
      --bg:#0b0f14;--card:#111826;--muted:#7b8aa0;--accent:#4f8bff;--ok:#14b8a6;--err:#ef4444;--radius:16px
    }
    *{box-sizing:border-box;font-family:system-ui,-apple-system,Segoe UI,Roboto,Inter,Arial}
    body{margin:0;background:linear-gradient(135deg,#0b0f14 0%,#0f172a 100%);color:#e5e7eb;display:grid;min-height:100dvh;place-items:center;padding:24px}
    .wrap{width:100%;max-width:980px;display:grid;grid-template-columns:1.1fr .9fr;gap:24px}
    @media(max-width:900px){.wrap{grid-template-columns:1fr}}
    .card{background:rgba(17,24,38,.9);backdrop-filter:blur(8px);border:1px solid rgba(255,255,255,.06);border-radius:var(--radius);box-shadow:0 10px 40px rgba(0,0,0,.35)}
    .brand{padding:28px}
    .brand h1{margin:0 0 8px;font-size:28px}
    .brand p{margin:0;color:var(--muted)}
    .tabs{display:flex;gap:8px;padding:12px;border-bottom:1px solid rgba(255,255,255,.06)}
    .tab{flex:1;padding:12px 14px;text-align:center;border-radius:12px;cursor:pointer;color:#cbd5e1;background:transparent;border:1px solid transparent}
    .tab.active{background:#0b1220;border-color:rgba(255,255,255,.08);color:#fff}
    .tab:hover{background:#0c1424}
    form{display:none;padding:20px}
    form.active{display:block}
    .field{margin:12px 0}
    label{display:block;font-size:13px;color:#9fb0c9;margin:0 0 6px}
    input{width:100%;padding:12px 14px;border-radius:12px;background:#0b1220;border:1px solid #1f2a44;color:#e5e7eb}
    input:focus{outline:none;border-color:#355399;box-shadow:0 0 0 3px rgba(79,139,255,.2)}
    .row{display:flex;justify-content:space-between;align-items:center}
    .btn{display:inline-flex;align-items:center;justify-content:center;gap:10px;border:0;border-radius:14px;padding:12px 16px;background:var(--accent);color:#fff;font-weight:600;cursor:pointer}
    .btn.secondary{background:#0b1220;border:1px solid #24324f;color:#cbd5e1}
    .btn:disabled{opacity:.6;cursor:not-allowed}
    .hint{font-size:12px;color:var(--muted)}
    .msg{margin:12px 0;padding:12px;border-radius:12px;display:none}
    .msg.show{display:block}
    .msg.ok{background:rgba(20,184,166,.12);border:1px solid rgba(20,184,166,.35);color:#c7f9f3}
    .msg.err{background:rgba(239,68,68,.12);border:1px solid rgba(239,68,68,.35);color:#fecaca}
    .legal{font-size:12px;color:#8aa0bd;margin-top:16px}
    .hero{padding:28px;display:grid;gap:16px}
    .hero .panel{background:#0b1220;border:1px dashed rgba(255,255,255,.08);border-radius:14px;padding:16px}
    .hero h2{margin:0 0 6px}
    .list{margin:8px 0 0 18px;color:#9fb0c9}
    .tag{display:inline-block;padding:6px 10px;border:1px solid #274173;background:#0b1220;border-radius:999px;color:#9fb0c9;font-size:12px}
  </style>
</head>
<body>
  <div class="wrap">
    <div class="card">
      <div class="brand">
        <h1>ClothsByRudra — Account</h1>
        <p>Login, Register, ya Forgot Password — ek hi page par. Duplicate forms nahi aayenge.</p>
      </div>
      <div class="tabs">
        <button class="tab active" data-tab="login">Login</button>
        <button class="tab" data-tab="register">Register</button>
        <button class="tab" data-tab="forgot">Forgot Password</button>
      </div>

      <!-- LOGIN -->
      <form id="form-login" class="active" autocomplete="on">
        <div class="msg" id="login-msg"></div>
        <div class="field">
          <label for="login-email">Email</label>
          <input id="login-email" type="email" placeholder="you@example.com" required />
        </div>
        <div class="field">
          <label for="login-pass">Password</label>
          <input id="login-pass" type="password" placeholder="••••••••" minlength="6" required />
        </div>
        <div class="row" style="gap:12px;flex-wrap:wrap">
          <button class="btn" type="submit">Login</button>
          <button class="btn secondary" type="button" data-go="register">Create account</button>
          <button class="btn secondary" type="button" data-go="forgot">Forgot password</button>
        </div>
        <p class="legal">Demo build (no server). For real auth, connect API later.</p>
      </form>

      <!-- REGISTER -->
      <form id="form-register" novalidate>
        <div class="msg" id="register-msg"></div>
        <div class="field">
          <label for="reg-name">Full name</label>
          <input id="reg-name" type="text" placeholder="Your name" required />
        </div>
        <div class="field">
          <label for="reg-email">Email</label>
          <input id="reg-email" type="email" placeholder="you@example.com" required />
        </div>
        <div class="field">
          <label for="reg-pass">Password</label>
          <input id="reg-pass" type="password" placeholder="Min 6 characters" minlength="6" required />
        </div>
        <div class="row" style="gap:12px;flex-wrap:wrap">
          <button class="btn" type="submit">Create account</button>
          <button class="btn secondary" type="button" data-go="login">Back to login</button>
        </div>
        <p class="hint">Password 6+ chars hona chahiye. Email unique hoga.</p>
      </form>

      <!-- FORGOT -->
      <form id="form-forgot">
        <div class="msg" id="forgot-msg"></div>
        <div class="field">
          <label for="forgot-email">Email</label>
          <input id="forgot-email" type="email" placeholder="you@example.com" required />
        </div>
        <div class="row" style="gap:12px;flex-wrap:wrap">
          <button class="btn" type="submit">Send reset link</button>
          <button class="btn secondary" type="button" data-go="login">Back to login</button>
        </div>
        <p class="hint">Demo: email console me print hoga. (GitHub Pages pe kaam karega)</p>
      </form>
    </div>

    <div class="card hero">
      <h2>How to connect pages</h2>
      <div class="panel">
        <p class="hint">Home/Product page se is auth page ko aise open karo:</p>
        <code class="tag">&lt;a href="/auth.html"&gt;Login / Account&lt;/a&gt;</code>
        <p class="hint" style="margin-top:8px">GitHub Pages repo root me file ka naam <strong>auth.html</strong> rakho.</p>
      </div>
      <div class="panel">
        <h3 style="margin:0 0 8px">Common Problems Fixed</h3>
        <ul class="list">
          <li>Duplicate login forms: single-page tabs ensure ek hi form dikhe.</li>
          <li>Register/Forgot nahi dikh raha: tabs & buttons se reliable toggle.</li>
          <li>No backend? Demo storage localStorage me (email → hash).</li>
        </ul>
      </div>
      <div class="panel">
        <h3 style="margin:0 0 8px">Next Step (Real Backend)</h3>
        <p class="hint">Later you can swap <em>fakeAuth</em> with real API (Firebase / Supabase / custom Node).</p>
      </div>
    </div>
  </div>

  <script>
    // ---------- Tiny helpers ----------
    const $ = (sel, ctx=document) => ctx.querySelector(sel);
    const $$ = (sel, ctx=document) => Array.from(ctx.querySelectorAll(sel));
    const showMsg = (el, type, text) => { el.className = 'msg show '+type; el.textContent = text };

    // ---------- Tabs / navigation (no duplicates) ----------
    const tabs = $$('.tab');
    const forms = {
      login: $('#form-login'),
      register: $('#form-register'),
      forgot: $('#form-forgot')
    };

    function activate(which){
      tabs.forEach(t=>t.classList.toggle('active', t.dataset.tab===which));
      Object.entries(forms).forEach(([k, f])=>f.classList.toggle('active', k===which));
      window.location.hash = which; // deep-link support
    }

    tabs.forEach(t=>t.addEventListener('click',()=>activate(t.dataset.tab)));
    document.addEventListener('click', (e)=>{
      const go = e.target.closest('[data-go]');
      if(go){ activate(go.dataset.go); }
    });

    // Open from hash (#register / #forgot)
    const initial = (location.hash.replace('#','')||'login');
    if(['login','register','forgot'].includes(initial)) activate(initial);

    // ---------- Demo Auth (localStorage) ----------
    const fakeAuth = {
      key: 'cbr_users_v1',
      read(){ try{ return JSON.parse(localStorage.getItem(this.key)||'{}') }catch{ return {} } },
      write(db){ localStorage.setItem(this.key, JSON.stringify(db)) },
      exists(email){ return !!this.read()[email] },
      create({name,email,pass}){
        const db = this.read();
        if(db[email]) throw new Error('Email already registered');
        db[email] = { name, pass };
        this.write(db);
      },
      login({email,pass}){
        const db = this.read();
        if(!db[email]) throw new Error('No account found');
        if(db[email].pass !== pass) throw new Error('Incorrect password');
        sessionStorage.setItem('cbr_session', JSON.stringify({email, time:Date.now()}));
      },
      reset(email){
        if(!this.exists(email)) throw new Error('No account found');
        // Demo: just log a pretend link
        const link = location.origin + location.pathname.replace(/[^\/]+$/,'') + 'reset.html?email=' + encodeURIComponent(email);
        console.log('[Demo reset link]', link);
        return link;
      }
    };

    // ---------- Form handlers ----------
    $('#form-register').addEventListener('submit', (e)=>{
      e.preventDefault();
      const name=$('#reg-name').value.trim();
      const email=$('#reg-email').value.trim().toLowerCase();
      const pass=$('#reg-pass').value;
      const msg=$('#register-msg');
      if(!name||!email||pass.length<6){ return showMsg(msg,'err','Please fill all fields (password 6+).') }
      try{
        fakeAuth.create({name,email,pass});
        showMsg(msg,'ok','Account created. You can login now.');
        setTimeout(()=>activate('login'), 900);
      }catch(err){ showMsg(msg,'err', err.message) }
    });

    $('#form-login').addEventListener('submit', (e)=>{
      e.preventDefault();
      const email=$('#login-email').value.trim().toLowerCase();
      const pass=$('#login-pass').value;
      const msg=$('#login-msg');
      try{
        fakeAuth.login({email,pass});
        showMsg(msg,'ok','Login successful! Redirecting to home…');
        setTimeout(()=>{ window.location.href = '/index.html'; }, 800);
      }catch(err){ showMsg(msg,'err', err.message) }
    });

    $('#form-forgot').addEventListener('submit', (e)=>{
      e.preventDefault();
      const email=$('#forgot-email').value.trim().toLowerCase();
      const msg=$('#forgot-msg');
      try{
        const link = fakeAuth.reset(email);
        showMsg(msg,'ok','Reset link generated (check console).');
        // Also display a safe version for demo
        const a=document.createElement('a'); a.href=link; a.textContent='Open reset link'; a.className='tag'; a.style.display='inline-block'; a.style.marginTop='8px';
        msg.appendChild(document.createElement('br')); msg.appendChild(a);
      }catch(err){ showMsg(msg,'err', err.message) }
    });
  </script>
</body>
</html>
